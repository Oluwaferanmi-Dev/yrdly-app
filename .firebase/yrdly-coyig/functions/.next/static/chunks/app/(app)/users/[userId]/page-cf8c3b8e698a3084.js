(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1267],{1026:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>q});var r=t(5155),i=t(2115),l=t(5695),c=t(5317),a=t(1427),n=t(6104),d=t(8030),u=t(1394),o=t(285),h=t(6695),x=t(8856),m=t(157);let j=(0,m.A)("ShieldBan",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]]);var f=t(4063);let b=(0,m.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var v=t(518),p=t(5318),w=t(3896),N=t(3561),k=t(3662),y=t(7481),g=t(10),C=t(4838);let U=()=>(0,r.jsxs)(h.Zp,{className:"max-w-2xl mx-auto",children:[(0,r.jsxs)(h.aR,{className:"flex flex-col items-center text-center p-6 bg-muted/50",children:[(0,r.jsx)(x.E,{className:"h-24 w-24 rounded-full mb-4"}),(0,r.jsx)(x.E,{className:"h-8 w-48 mb-2"}),(0,r.jsx)(x.E,{className:"h-5 w-32"})]}),(0,r.jsxs)(h.Wu,{className:"p-6",children:[(0,r.jsx)(x.E,{className:"h-6 w-full mb-4"}),(0,r.jsx)(x.E,{className:"h-5 w-3/4"})]}),(0,r.jsx)(h.wL,{className:"p-6 justify-center",children:(0,r.jsx)(x.E,{className:"h-10 w-32"})})]});function q(){var e;let{userId:s}=(0,l.useParams)(),{user:t,userDetails:x}=(0,d.A)(),{toast:m}=(0,y.dj)(),q=(0,l.useRouter)(),[E,_]=(0,i.useState)(null),[A,I]=(0,i.useState)(null),[S,$]=(0,i.useState)(null),[H,R]=(0,i.useState)(!1),[B,Z]=(0,i.useState)(!0);(0,i.useEffect)(()=>{var e,r;if(!s||!t)return;if(s===t.uid){let e=(0,c.H9)(n.db,"users",t.uid),s=(0,c.aQ)(e,e=>{e.exists()&&_({id:e.id,...e.data()}),Z(!1)});return()=>s()}(null==x||null==(e=x.blockedUsers)?void 0:e.includes(s))&&R(!0);let i=(0,c.H9)(n.db,"users",s),l=(0,c.aQ)(i,e=>{e.exists()&&_({id:e.id,...e.data()}),Z(!1)});if(null==x||null==(r=x.friends)?void 0:r.some(e=>e.uid===s))I("friends");else{let e=(0,c.P)((0,c.rJ)(n.db,"friend_requests"),(0,c._M)("fromUserId","in",[t.uid,s]),(0,c._M)("toUserId","in",[t.uid,s])),r=(0,c.aQ)(e,e=>{let r=e.docs.find(e=>{let r=e.data();return r.fromUserId===t.uid&&r.toUserId===s||r.fromUserId===s&&r.toUserId===t.uid});if(r){let e={id:r.id,...r.data()};$(e),"pending"===e.status?I(e.fromUserId===t.uid?"request_sent":"request_received"):I("none")}else I("none"),$(null)});return()=>r()}return()=>l()},[s,t,x]);let F=async()=>{if(t&&E&&!H)try{await (0,c.gS)((0,c.rJ)(n.db,"friend_requests"),{fromUserId:t.uid,toUserId:E.uid,status:"pending",timestamp:(0,c.O5)()}),m({title:"Friend request sent!"})}catch(e){m({variant:"destructive",title:"Error",description:"Could not send friend request."})}},Q=async()=>{if(t&&S)try{let e=(0,a.Qg)(n.functions,"acceptfriendrequest");await e({friendRequestId:S.id}),m({title:"Friend request accepted!"})}catch(e){m({variant:"destructive",title:"Error",description:"Could not accept friend request."})}},L=async()=>{if(!S)return;let e=(0,c.H9)(n.db,"friend_requests",S.id);await (0,c.mZ)(e,{status:"declined"}),m({title:"Friend request declined."})},M=async()=>{if(t&&E)try{await (0,c.c4)(n.db,async e=>{let s=(0,c.H9)(n.db,"users",t.uid),r=(0,c.H9)(n.db,"users",E.uid);e.update(s,{friends:(0,c.C3)(E.uid)}),e.update(r,{friends:(0,c.C3)(t.uid)})}),m({title:"Friend removed."})}catch(e){m({variant:"destructive",title:"Error",description:"Could not remove friend."})}},O=async()=>{if(!t||!E)return;let e=(0,c.H9)(n.db,"users",t.uid);try{await (0,c.mZ)(e,{blockedUsers:(0,c.hq)(E.uid)}),"friends"===A&&await M(),R(!0),m({title:"User blocked."})}catch(e){m({variant:"destructive",title:"Error",description:"Could not block user."})}},z=async()=>{if(!t||!E)return;let e=(0,c.H9)(n.db,"users",t.uid);try{await (0,c.mZ)(e,{blockedUsers:(0,c.C3)(E.uid)}),R(!1),m({title:"User unblocked."})}catch(e){m({variant:"destructive",title:"Error",description:"Could not unblock user."})}};return B?(0,r.jsx)(U,{}):E?(0,r.jsxs)(h.Zp,{className:"max-w-2xl mx-auto",children:[(0,r.jsxs)(h.aR,{className:"flex flex-col items-center text-center p-6 bg-muted/50 relative",children:[E.uid!==(null==t?void 0:t.uid)&&(0,r.jsx)("div",{className:"absolute top-4 right-4",children:(0,r.jsxs)(C.rI,{children:[(0,r.jsx)(C.ty,{asChild:!0,children:(0,r.jsx)(o.$,{variant:"ghost",size:"icon",children:(0,r.jsx)(N.A,{className:"h-5 w-5"})})}),(0,r.jsx)(C.SQ,{children:(0,r.jsxs)(g.Lt,{children:[(0,r.jsx)(g.tv,{asChild:!0,children:(0,r.jsxs)(C._2,{onSelect:e=>e.preventDefault(),className:"text-destructive",children:[(0,r.jsx)(j,{className:"mr-2 h-4 w-4"})," ",H?"Unblock":"Block"," User"]})}),(0,r.jsxs)(g.EO,{children:[(0,r.jsxs)(g.wd,{children:[(0,r.jsx)(g.r7,{children:"Are you sure?"}),(0,r.jsx)(g.$v,{children:H?"This will unblock ".concat(E.name,"."):"This will block ".concat(E.name,". You will no longer see their content or be able to interact with them.")})]}),(0,r.jsxs)(g.ck,{children:[(0,r.jsx)(g.Zr,{children:"Cancel"}),(0,r.jsx)(g.Rx,{onClick:H?z:O,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:H?"Unblock":"Block"})]})]})]})})]})}),(0,r.jsxs)(u.eu,{className:"h-24 w-24 mb-4 border-2 border-background",children:[(0,r.jsx)(u.BK,{src:E.avatarUrl,alt:E.name}),(0,r.jsx)(u.q5,{children:E.name.charAt(0)})]}),(0,r.jsx)("h1",{className:"text-2xl font-bold",children:E.name}),E.location&&(0,r.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[(0,r.jsx)(k.A,{className:"h-4 w-4 mr-1"}),(0,r.jsx)("span",{children:(e=E.location)?[e.city,e.lga,e.state].filter(Boolean).join(", "):"Location not set"})]})]}),(0,r.jsxs)(h.Wu,{className:"p-6",children:[(0,r.jsx)("h2",{className:"font-semibold text-lg mb-2",children:"Bio"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:E.bio||"This user hasn't written a bio yet."})]}),(0,r.jsx)(h.wL,{className:"p-6 justify-center",children:(()=>{if(!E||E.uid===(null==t?void 0:t.uid))return null;if(H)return(0,r.jsxs)(o.$,{onClick:z,variant:"destructive",children:[(0,r.jsx)(j,{className:"mr-2 h-4 w-4"})," Unblock User"]});switch(A){case"friends":return(0,r.jsxs)(o.$,{onClick:()=>q.push("/messages?convId=".concat(E.uid)),children:[(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Message"]});case"request_sent":return(0,r.jsxs)(o.$,{disabled:!0,children:[(0,r.jsx)(b,{className:"mr-2 h-4 w-4"})," Request Sent"]});case"request_received":return(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(o.$,{onClick:Q,children:[(0,r.jsx)(v.A,{className:"mr-2 h-4 w-4"})," Accept Request"]}),(0,r.jsxs)(o.$,{variant:"outline",onClick:L,children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"})," Decline"]})]});default:return(0,r.jsxs)(o.$,{onClick:F,children:[(0,r.jsx)(w.A,{className:"mr-2 h-4 w-4"})," Add Friend"]})}})()})]}):(0,r.jsx)("div",{className:"text-center py-10",children:"User not found."})}},3561:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(157).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},4753:(e,s,t)=>{Promise.resolve().then(t.bind(t,1026))}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,3340,3504,1171,3190,8544,1662,3428,5822,8441,1684,7358],()=>s(4753)),_N_E=e.O()}]);