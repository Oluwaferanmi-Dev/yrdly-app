(()=>{var e={};e.id=164,e.ids=[164],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},34729:(e,s,t)=>{"use strict";t.d(s,{T:()=>i});var r=t(60687),a=t(43210),n=t(4780);let i=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:t,...s}));i.displayName="Textarea"},37366:e=>{"use strict";e.exports=require("dns")},53573:(e,s,t)=>{Promise.resolve().then(t.bind(t,55252))},53588:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\USER\\\\Documents\\\\CODE\\\\yrdly-app\\\\src\\\\app\\\\(app)\\\\messages\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\USER\\Documents\\CODE\\yrdly-app\\src\\app\\(app)\\messages\\page.tsx","default")},55252:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var r=t(60687),a=t(43210),n=t(32584),i=t(29523),l=t(44493),d=t(89667),o=t(42692),c=t(4780),p=t(48206),u=t(41936),x=t(82614);let m=(0,x.A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),h=(0,x.A)("SendHorizontal",[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]]);var f=t(34729),g=t(75535),b=t(33784),v=t(85814),j=t.n(v);function y({title:e="Find your neighbors",description:s="It looks like you haven't started any conversations yet. Once you do, they'll appear here.",buttonText:t="Find Neighbors",buttonLink:a="/neighbors"}){return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground p-4 text-center bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[(0,r.jsx)("div",{className:"mb-4 rounded-full bg-primary/10 p-4",children:(0,r.jsx)(p.A,{className:"h-10 w-10 text-primary"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-foreground mb-1",children:e}),(0,r.jsx)("p",{className:"mb-4 max-w-sm",children:s}),(0,r.jsx)(i.$,{asChild:!0,children:(0,r.jsx)(j(),{href:a,children:t})})]})}function N({conversations:e,currentUser:s}){let[t,p]=(0,a.useState)(e),[x,v]=(0,a.useState)(null),[j,N]=(0,a.useState)([]),[w,E]=(0,a.useState)(""),q=(0,a.useRef)(null),k=async e=>{if(e.preventDefault(),""===w.trim()||!x)return;let t=(0,g.H9)(b.db,"conversations",x.id),r=(0,g.rJ)(t,"messages");try{await (0,g.c4)(b.db,async e=>{await (0,g.gS)(r,{senderId:s.id,text:w,timestamp:(0,g.O5)(),read:!1}),e.update(t,{lastMessage:{text:w,senderId:s.id,timestamp:(0,g.O5)(),read:!1}})}),E("")}catch(e){console.error("Error sending message: ",e)}};return(0,r.jsxs)(l.Zp,{className:"h-[calc(100vh-10rem)] w-full flex overflow-hidden",children:[(0,r.jsxs)("div",{className:(0,c.cn)("w-full md:w-1/3 border-r transition-transform duration-300 ease-in-out flex flex-col","md:translate-x-0",x?"-translate-x-full":"translate-x-0"),children:[(0,r.jsxs)("div",{className:"p-4 border-b",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Messages"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(d.p,{placeholder:"Search messages",className:"pl-8"})]})]}),(0,r.jsx)(o.F,{className:"flex-1",children:t.length>0?t.map(e=>(0,r.jsxs)("div",{className:(0,c.cn)("flex items-center gap-4 p-4 cursor-pointer hover:bg-muted/50",x?.id===e.id&&"bg-muted/50"),onClick:()=>v(e),children:[(0,r.jsxs)(n.eu,{children:[(0,r.jsx)(n.BK,{src:e.participant.avatarUrl,alt:e.participant.name}),(0,r.jsx)(n.q5,{children:e.participant.name.charAt(0)})]}),(0,r.jsxs)("div",{className:"flex-1 truncate",children:[(0,r.jsx)("p",{className:"font-semibold",children:e.participant.name}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:e.messages[e.messages.length-1]?.text})]})]},e.id)):(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)(y,{title:"No conversations",description:"You don't have any messages yet. Start a conversation with a friend!",buttonText:"Find Friends",buttonLink:"/neighbors"})})})]}),(0,r.jsx)("div",{className:(0,c.cn)("w-full md:w-2/3 flex flex-col absolute md:static inset-0 transition-transform duration-300 ease-in-out bg-background","md:translate-x-0",x?"translate-x-0":"translate-x-full"),children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 p-3 border-b",children:[(0,r.jsx)(i.$,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>v(null),children:(0,r.jsx)(m,{className:"h-5 w-5"})}),(0,r.jsxs)(n.eu,{children:[(0,r.jsx)(n.BK,{src:x.participant.avatarUrl,alt:x.participant.name}),(0,r.jsx)(n.q5,{children:x.participant.name.charAt(0)})]}),(0,r.jsx)("p",{className:"font-semibold",children:x.participant.name})]}),(0,r.jsx)(o.F,{ref:q,className:"flex-1 p-4 bg-gray-50 dark:bg-gray-900",children:(0,r.jsx)("div",{className:"space-y-4",children:j.map(e=>(0,r.jsxs)("div",{className:(0,c.cn)("flex gap-3",e.sender.id===s.id?"justify-end":"justify-start"),children:[e.sender.id!==s.id&&(0,r.jsxs)(n.eu,{className:"h-8 w-8",children:[(0,r.jsx)(n.BK,{src:e.sender.avatarUrl}),(0,r.jsx)(n.q5,{children:e.sender.name.charAt(0)})]}),(0,r.jsxs)("div",{className:(0,c.cn)("rounded-lg px-4 py-2 max-w-xs lg:max-w-md break-words",e.sender.id===s.id?"bg-primary text-primary-foreground":"bg-card border"),children:[(0,r.jsx)("p",{children:e.text}),(0,r.jsx)("p",{className:(0,c.cn)("text-xs opacity-70 mt-1",e.sender.id===s.id?"text-right":"text-left"),children:e.timestamp})]})]},e.id))})}),(0,r.jsx)("div",{className:"p-4 border-t bg-card",children:(0,r.jsxs)("form",{onSubmit:k,className:"flex items-center gap-2",children:[(0,r.jsx)(f.T,{placeholder:"Type a message...",value:w,onChange:e=>E(e.target.value),className:"flex-1 resize-none",rows:1,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k(e))}}),(0,r.jsx)(i.$,{type:"submit",size:"icon",disabled:!w.trim(),children:(0,r.jsx)(h,{className:"h-5 w-5"})})]})})]}):(0,r.jsx)("div",{className:"hidden md:flex flex-1 items-center justify-center text-muted-foreground p-8",children:(0,r.jsx)(y,{title:"Select a conversation",description:"Choose one of your existing conversations to see the messages.",buttonText:"Find Friends",buttonLink:"/neighbors"})})})]})}var w=t(68504),E=t(85726);let q=()=>(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(E.E,{className:"h-12 w-12 rounded-full"}),(0,r.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,r.jsx)(E.E,{className:"h-4 w-3/4"}),(0,r.jsx)(E.E,{className:"h-4 w-1/2"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(E.E,{className:"h-12 w-12 rounded-full"}),(0,r.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,r.jsx)(E.E,{className:"h-4 w-3/4"}),(0,r.jsx)(E.E,{className:"h-4 w-1/2"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(E.E,{className:"h-12 w-12 rounded-full"}),(0,r.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,r.jsx)(E.E,{className:"h-4 w-3/4"}),(0,r.jsx)(E.E,{className:"h-4 w-1/2"})]})]})]});function k(){let{user:e,userDetails:s}=(0,w.A)(),[t,n]=(0,a.useState)([]),[i,l]=(0,a.useState)(!0),d=(0,a.useMemo)(()=>e?{id:e.uid,uid:e.uid,name:e.displayName||"Anonymous",avatarUrl:e.photoURL||"https://placehold.co/100x100.png"}:null,[e]);return i?(0,r.jsx)(q,{}):d&&s?.friends&&0!==s.friends.length?(0,r.jsx)(N,{conversations:t,currentUser:d}):(0,r.jsx)(y,{title:"No Friends Yet",description:"You haven't added any friends yet. Find neighbors and send them a friend request to start chatting!",buttonText:"Find Neighbors",buttonLink:"/neighbors"})}},55511:e=>{"use strict";e.exports=require("crypto")},59653:(e,s,t)=>{Promise.resolve().then(t.bind(t,53588))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94702:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>o});var r=t(65239),a=t(48088),n=t(88170),i=t.n(n),l=t(30893),d={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let o={children:["",{children:["(app)",{children:["messages",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,53588)),"C:\\Users\\USER\\Documents\\CODE\\yrdly-app\\src\\app\\(app)\\messages\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,70718)),"C:\\Users\\USER\\Documents\\CODE\\yrdly-app\\src\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,61137)),"C:\\Users\\USER\\Documents\\CODE\\yrdly-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\USER\\Documents\\CODE\\yrdly-app\\src\\app\\(app)\\messages\\page.tsx"],p={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(app)/messages/page",pathname:"/messages",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},94735:e=>{"use strict";e.exports=require("events")}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[447,956,934,850,474,870,401,835],()=>t(94702));module.exports=r})();