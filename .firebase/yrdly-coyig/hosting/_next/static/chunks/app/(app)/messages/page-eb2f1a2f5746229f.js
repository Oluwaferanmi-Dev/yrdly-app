(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{285:(e,s,r)=>{"use strict";r.d(s,{$:()=>c});var a=r(5155),t=r(2115),l=r(4253),i=r(2085),n=r(9434);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=t.forwardRef((e,s)=>{let{className:r,variant:t,size:i,asChild:c=!1,...o}=e,u=c?l.DX:"button";return(0,a.jsx)(u,{className:(0,n.cn)(d({variant:t,size:i,className:r})),ref:s,...o})});c.displayName="Button"},1394:(e,s,r)=>{"use strict";r.d(s,{BK:()=>d,eu:()=>n,q5:()=>c});var a=r(5155),t=r(2115),l=r(5977),i=r(9434);let n=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(l.bL,{ref:s,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...t})});n.displayName=l.bL.displayName;let d=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(l._V,{ref:s,className:(0,i.cn)("aspect-square h-full w-full",r),...t})});d.displayName=l._V.displayName;let c=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(l.H4,{ref:s,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...t})});c.displayName=l.H4.displayName},2523:(e,s,r)=>{"use strict";r.d(s,{p:()=>i});var a=r(5155),t=r(2115),l=r(9434);let i=t.forwardRef((e,s)=>{let{className:r,type:t,...i}=e;return(0,a.jsx)("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...i})});i.displayName="Input"},4607:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>E});var a=r(5155),t=r(2115),l=r(1394),i=r(285),n=r(6695),d=r(2523),c=r(7655),o=r(9434);let u=t.forwardRef((e,s)=>{let{className:r,children:t,...l}=e;return(0,a.jsxs)(c.bL,{ref:s,className:(0,o.cn)("relative overflow-hidden",r),...l,children:[(0,a.jsx)(c.LM,{className:"h-full w-full rounded-[inherit]",children:t}),(0,a.jsx)(m,{}),(0,a.jsx)(c.OK,{})]})});u.displayName=c.bL.displayName;let m=t.forwardRef((e,s)=>{let{className:r,orientation:t="vertical",...l}=e;return(0,a.jsx)(c.VM,{ref:s,orientation:t,className:(0,o.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...l,children:(0,a.jsx)(c.lr,{className:"relative flex-1 rounded-full bg-border"})})});m.displayName=c.VM.displayName;var f=r(286),x=r(5074),p=r(2543),h=r(7687),g=r(8539),v=r(5317),b=r(6104);function j(){return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground p-4 text-center bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[(0,a.jsx)("div",{className:"mb-4 rounded-full bg-primary/10 p-4",children:(0,a.jsx)(f.A,{className:"h-10 w-10 text-primary"})}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-foreground mb-1",children:"Find your neighbors"}),(0,a.jsx)("p",{className:"mb-4 max-w-sm",children:"It looks like you haven't started any conversations yet. Once you do, they'll appear here."}),(0,a.jsx)(i.$,{children:"Find Neighbors"})]})}function N(e){let{conversations:s,currentUser:r}=e,[c,m]=(0,t.useState)(s),[f,N]=(0,t.useState)(null),[y,w]=(0,t.useState)([]),[k,E]=(0,t.useState)("");(0,t.useEffect)(()=>{m(s)},[s]),(0,t.useEffect)(()=>{if(!f)return;let e=(0,v.P)((0,v.rJ)(b.db,"conversations",f.id,"messages"),(0,v.My)("timestamp","asc")),s=(0,v.aQ)(e,async e=>{let s=[];for(let t of e.docs){var a;let e=t.data(),l=e.senderId===r.id?r:f.participant;if(e.senderId!==r.id&&e.senderId!==f.participant.id){let s=await (0,v.x7)((0,v.H9)(b.db,"users",e.senderId));s.exists()&&(l={id:s.id,...s.data()})}s.push({id:t.id,text:e.text,sender:l,timestamp:(null==(a=e.timestamp)?void 0:a.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"...",read:e.read})}w(s)});return()=>s()},[f,r]);let I=e=>{e.preventDefault(),""!==k.trim()&&f&&(console.log("Sending message:",k),E(""))},C=e=>{N(e)};return(0,a.jsxs)(n.Zp,{className:"h-[calc(100vh-10rem)] w-full flex overflow-hidden",children:[(0,a.jsxs)("div",{className:(0,o.cn)("w-full md:w-1/3 border-r transition-transform duration-300 ease-in-out flex flex-col","md:translate-x-0",f?"-translate-x-full":"translate-x-0"),children:[(0,a.jsxs)("div",{className:"p-4 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Messages"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(d.p,{placeholder:"Search messages",className:"pl-8"})]})]}),(0,a.jsx)(u,{className:"flex-1",children:c.length>0?c.map(e=>{var s;return(0,a.jsxs)("div",{className:(0,o.cn)("flex items-center gap-4 p-4 cursor-pointer hover:bg-muted/50",(null==f?void 0:f.id)===e.id&&"bg-muted/50"),onClick:()=>C(e),children:[(0,a.jsxs)(l.eu,{children:[(0,a.jsx)(l.BK,{src:e.participant.avatarUrl,alt:e.participant.name,"data-ai-hint":"person portrait"}),(0,a.jsx)(l.q5,{children:e.participant.name.charAt(0)})]}),(0,a.jsxs)("div",{className:"flex-1 truncate",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.participant.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:null==(s=e.messages[e.messages.length-1])?void 0:s.text})]})]},e.id)}):(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(j,{})})})]}),(0,a.jsx)("div",{className:(0,o.cn)("w-full md:w-2/3 flex flex-col absolute md:static inset-0 transition-transform duration-300 ease-in-out bg-background","md:translate-x-0",f?"translate-x-0":"translate-x-full"),children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 p-3 border-b",children:[(0,a.jsx)(i.$,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>N(null),children:(0,a.jsx)(p.A,{className:"h-5 w-5"})}),(0,a.jsxs)(l.eu,{children:[(0,a.jsx)(l.BK,{src:f.participant.avatarUrl,alt:f.participant.name,"data-ai-hint":"person portrait"}),(0,a.jsx)(l.q5,{children:f.participant.name.charAt(0)})]}),(0,a.jsx)("p",{className:"font-semibold",children:f.participant.name})]}),(0,a.jsx)(u,{className:"flex-1 p-4 bg-gray-50 dark:bg-gray-900",children:(0,a.jsx)("div",{className:"space-y-4",children:y.map(e=>(0,a.jsxs)("div",{className:(0,o.cn)("flex gap-3",e.sender.id===r.id?"justify-end":"justify-start"),children:[e.sender.id!==r.id&&(0,a.jsxs)(l.eu,{className:"h-8 w-8",children:[(0,a.jsx)(l.BK,{src:e.sender.avatarUrl,"data-ai-hint":"person portrait"}),(0,a.jsx)(l.q5,{children:e.sender.name.charAt(0)})]}),(0,a.jsxs)("div",{className:(0,o.cn)("rounded-lg px-4 py-2 max-w-xs lg:max-w-md break-words",e.sender.id===r.id?"bg-primary text-primary-foreground":"bg-card border"),children:[(0,a.jsx)("p",{children:e.text}),(0,a.jsx)("p",{className:(0,o.cn)("text-xs opacity-70 mt-1",e.sender.id===r.id?"text-right":"text-left"),children:e.timestamp})]})]},e.id))})}),(0,a.jsx)("div",{className:"p-4 border-t bg-card",children:(0,a.jsxs)("form",{onSubmit:I,className:"flex items-center gap-2",children:[(0,a.jsx)(g.T,{placeholder:"Type a message...",value:k,onChange:e=>E(e.target.value),className:"flex-1 resize-none",rows:1,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),I(e))}}),(0,a.jsx)(i.$,{type:"submit",size:"icon",disabled:!k.trim(),children:(0,a.jsx)(h.A,{className:"h-5 w-5"})})]})})]}):(0,a.jsx)("div",{className:"hidden md:flex flex-1 items-center justify-center text-muted-foreground p-8",children:(0,a.jsx)(j,{})})})]})}var y=r(8030),w=r(8856);let k=()=>(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(w.E,{className:"h-12 w-12 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsx)(w.E,{className:"h-4 w-3/4"}),(0,a.jsx)(w.E,{className:"h-4 w-1/2"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(w.E,{className:"h-12 w-12 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsx)(w.E,{className:"h-4 w-3/4"}),(0,a.jsx)(w.E,{className:"h-4 w-1/2"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(w.E,{className:"h-12 w-12 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsx)(w.E,{className:"h-4 w-3/4"}),(0,a.jsx)(w.E,{className:"h-4 w-1/2"})]})]})]});function E(){let{user:e}=(0,y.A)(),[s,r]=(0,t.useState)([]),[l,i]=(0,t.useState)(!0),n=e?{id:e.uid,uid:e.uid,name:e.displayName||"Anonymous",avatarUrl:e.photoURL||"https://placehold.co/100x100.png"}:null;return((0,t.useEffect)(()=>{if(!e)return void i(!1);let s=(0,v.P)((0,v.rJ)(b.db,"conversations"),(0,v._M)("participantIds","array-contains",e.uid)),a=(0,v.aQ)(s,async s=>{let a=s.docs.map(async s=>{var r;let a=s.data(),t=a.participantIds.find(s=>s!==e.uid);if(!t)return null;let l=await (0,v.x7)((0,v.H9)(b.db,"users",t));if(!l.exists())return null;let i={id:l.id,...l.data()};(0,v.P)((0,v.rJ)(b.db,"conversations",s.id,"messages"));let d=a.lastMessage;return{id:s.id,participant:i,messages:d?[{id:"last",sender:d.senderId===(null==n?void 0:n.id)?n:i,text:d.text,timestamp:(null==(r=d.timestamp)?void 0:r.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"...",read:d.read}]:[]}});r((await Promise.all(a)).filter(Boolean)),i(!1)});return()=>a()},[e,n]),l)?(0,a.jsx)(k,{}):n?(0,a.jsx)(N,{conversations:s,currentUser:n}):(0,a.jsx)(j,{})}},4711:(e,s,r)=>{Promise.resolve().then(r.bind(r,4607))},6104:(e,s,r)=>{"use strict";r.d(s,{IG:()=>o,db:()=>c,hJ:()=>u,j2:()=>d,sm:()=>m});var a=r(3915),t=r(3004),l=r(5317),i=r(858);let n=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({projectId:"yrdly-coyig",appId:"1:166095077947:web:2f5285213610bbd893521e",storageBucket:"yrdly-coyig.firebasestorage.app",apiKey:"AIzaSyCOE_L6g9c3J6jhcajVzNkC4flEao4Av2I",authDomain:"yrdly-coyig.firebaseapp.com",measurementId:"",messagingSenderId:"166095077947"}),d=(0,t.xI)(n),c=(0,l.aU)(n),o=(0,i.c7)(n),u=new t.HF,m=new t.LD("apple.com")},6695:(e,s,r)=>{"use strict";r.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>u});var a=r(5155),t=r(2115),l=r(9434);let i=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...t})});i.displayName="Card";let n=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...t})});n.displayName="CardHeader";let d=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...t})});d.displayName="CardTitle";let c=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",r),...t})});c.displayName="CardDescription";let o=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",r),...t})});o.displayName="CardContent";let u=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",r),...t})});u.displayName="CardFooter"},8030:(e,s,r)=>{"use strict";r.d(s,{A:()=>c,AuthProvider:()=>d});var a=r(5155),t=r(2115),l=r(3004),i=r(6104);let n=(0,t.createContext)({user:null,loading:!0}),d=e=>{let{children:s}=e,[r,d]=(0,t.useState)(null),[c,o]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{let e=(0,l.hg)(i.j2,e=>{d(e),o(!1)});return()=>e()},[]),(0,a.jsx)(n.Provider,{value:{user:r,loading:c},children:s})},c=()=>(0,t.useContext)(n)},8539:(e,s,r)=>{"use strict";r.d(s,{T:()=>i});var a=r(5155),t=r(2115),l=r(9434);let i=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...t})});i.displayName="Textarea"},8856:(e,s,r)=>{"use strict";r.d(s,{E:()=>l});var a=r(5155),t=r(9434);function l(e){let{className:s,...r}=e;return(0,a.jsx)("div",{className:(0,t.cn)("animate-pulse rounded-md bg-muted",s),...r})}},9434:(e,s,r)=>{"use strict";r.d(s,{cn:()=>l});var a=r(2596),t=r(9688);function l(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,t.QP)((0,a.$)(s))}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,644,340,504,780,739,441,684,358],()=>s(4711)),_N_E=e.O()}]);