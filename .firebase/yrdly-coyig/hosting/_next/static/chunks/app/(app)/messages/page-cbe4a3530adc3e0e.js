(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{285:(e,s,r)=>{"use strict";r.d(s,{$:()=>c,r:()=>d});var a=r(5155),t=r(2115),l=r(4253),n=r(2085),i=r(9434);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=t.forwardRef((e,s)=>{let{className:r,variant:t,size:n,asChild:c=!1,...o}=e,u=c?l.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(d({variant:t,size:n,className:r})),ref:s,...o})});c.displayName="Button"},1394:(e,s,r)=>{"use strict";r.d(s,{BK:()=>d,eu:()=>i,q5:()=>c});var a=r(5155),t=r(2115),l=r(5977),n=r(9434);let i=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(l.bL,{ref:s,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...t})});i.displayName=l.bL.displayName;let d=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(l._V,{ref:s,className:(0,n.cn)("aspect-square h-full w-full",r),...t})});d.displayName=l._V.displayName;let c=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)(l.H4,{ref:s,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...t})});c.displayName=l.H4.displayName},2523:(e,s,r)=>{"use strict";r.d(s,{p:()=>n});var a=r(5155),t=r(2115),l=r(9434);let n=t.forwardRef((e,s)=>{let{className:r,type:t,...n}=e;return(0,a.jsx)("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...n})});n.displayName="Input"},4607:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>C});var a=r(5155),t=r(2115),l=r(1394),n=r(285),i=r(6695),d=r(2523),c=r(7655),o=r(9434);let u=t.forwardRef((e,s)=>{let{className:r,children:t,...l}=e;return(0,a.jsxs)(c.bL,{className:(0,o.cn)("relative overflow-hidden",r),...l,children:[(0,a.jsx)(c.LM,{ref:s,className:"h-full w-full rounded-[inherit]",children:t}),(0,a.jsx)(m,{}),(0,a.jsx)(c.OK,{})]})});u.displayName=c.bL.displayName;let m=t.forwardRef((e,s)=>{let{className:r,orientation:t="vertical",...l}=e;return(0,a.jsx)(c.VM,{ref:s,orientation:t,className:(0,o.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...l,children:(0,a.jsx)(c.lr,{className:"relative flex-1 rounded-full bg-border"})})});m.displayName=c.VM.displayName;var f=r(286),x=r(5074),p=r(2543),h=r(7687),g=r(8539),v=r(5317),b=r(6104),j=r(6874),y=r.n(j);function N(){return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground p-4 text-center bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[(0,a.jsx)("div",{className:"mb-4 rounded-full bg-primary/10 p-4",children:(0,a.jsx)(f.A,{className:"h-10 w-10 text-primary"})}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-foreground mb-1",children:"Find your neighbors"}),(0,a.jsx)("p",{className:"mb-4 max-w-sm",children:"It looks like you haven't started any conversations yet. Once you do, they'll appear here."}),(0,a.jsx)(n.$,{asChild:!0,children:(0,a.jsx)(y(),{href:"/neighbors",children:"Find Neighbors"})})]})}function w(e){let{conversations:s,currentUser:r}=e,[c,m]=(0,t.useState)(s),[f,j]=(0,t.useState)(null),[y,w]=(0,t.useState)([]),[k,I]=(0,t.useState)(""),E=(0,t.useRef)(null);(0,t.useEffect)(()=>{m(s)},[s]),(0,t.useEffect)(()=>{if(!(null==f?void 0:f.id)||!(null==r?void 0:r.id))return;let e=(0,v.P)((0,v.rJ)(b.db,"conversations",f.id,"messages"),(0,v.My)("timestamp","asc")),s=(0,v.aQ)(e,async e=>{w(await Promise.all(e.docs.map(async e=>{var s;let a,t=e.data();if(t.senderId===r.id)a=r;else if(t.senderId===f.participant.id)a=f.participant;else{let e=await (0,v.x7)((0,v.H9)(b.db,"users",t.senderId));a=e.exists()?{id:e.id,...e.data()}:{id:t.senderId,uid:t.senderId,name:"Unknown",avatarUrl:""}}return{id:e.id,senderId:t.senderId,text:t.text,sender:a,timestamp:(null==(s=t.timestamp)?void 0:s.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"...",read:t.read}})))});return()=>s()},[null==f?void 0:f.id,null==r?void 0:r.id]),(0,t.useEffect)(()=>{E.current&&(E.current.scrollTop=E.current.scrollHeight)},[y]);let C=async e=>{if(e.preventDefault(),""===k.trim()||!f)return;let s=(0,v.H9)(b.db,"conversations",f.id),a=(0,v.rJ)(s,"messages");try{await (0,v.c4)(b.db,async e=>{await (0,v.gS)(a,{senderId:r.id,text:k,timestamp:(0,v.O5)(),read:!1}),e.update(s,{lastMessage:{text:k,senderId:r.id,timestamp:(0,v.O5)(),read:!1}})}),I("")}catch(e){console.error("Error sending message: ",e)}};return(0,a.jsxs)(i.Zp,{className:"h-[calc(100vh-10rem)] w-full flex overflow-hidden",children:[(0,a.jsxs)("div",{className:(0,o.cn)("w-full md:w-1/3 border-r transition-transform duration-300 ease-in-out flex flex-col","md:translate-x-0",f?"-translate-x-full":"translate-x-0"),children:[(0,a.jsxs)("div",{className:"p-4 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Messages"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(d.p,{placeholder:"Search messages",className:"pl-8"})]})]}),(0,a.jsx)(u,{className:"flex-1",children:c.length>0?c.map(e=>{var s;return(0,a.jsxs)("div",{className:(0,o.cn)("flex items-center gap-4 p-4 cursor-pointer hover:bg-muted/50",(null==f?void 0:f.id)===e.id&&"bg-muted/50"),onClick:()=>j(e),children:[(0,a.jsxs)(l.eu,{children:[(0,a.jsx)(l.BK,{src:e.participant.avatarUrl,alt:e.participant.name}),(0,a.jsx)(l.q5,{children:e.participant.name.charAt(0)})]}),(0,a.jsxs)("div",{className:"flex-1 truncate",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.participant.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:null==(s=e.messages[e.messages.length-1])?void 0:s.text})]})]},e.id)}):(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(N,{})})})]}),(0,a.jsx)("div",{className:(0,o.cn)("w-full md:w-2/3 flex flex-col absolute md:static inset-0 transition-transform duration-300 ease-in-out bg-background","md:translate-x-0",f?"translate-x-0":"translate-x-full"),children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 p-3 border-b",children:[(0,a.jsx)(n.$,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>j(null),children:(0,a.jsx)(p.A,{className:"h-5 w-5"})}),(0,a.jsxs)(l.eu,{children:[(0,a.jsx)(l.BK,{src:f.participant.avatarUrl,alt:f.participant.name}),(0,a.jsx)(l.q5,{children:f.participant.name.charAt(0)})]}),(0,a.jsx)("p",{className:"font-semibold",children:f.participant.name})]}),(0,a.jsx)(u,{ref:E,className:"flex-1 p-4 bg-gray-50 dark:bg-gray-900",children:(0,a.jsx)("div",{className:"space-y-4",children:y.map(e=>(0,a.jsxs)("div",{className:(0,o.cn)("flex gap-3",e.sender.id===r.id?"justify-end":"justify-start"),children:[e.sender.id!==r.id&&(0,a.jsxs)(l.eu,{className:"h-8 w-8",children:[(0,a.jsx)(l.BK,{src:e.sender.avatarUrl}),(0,a.jsx)(l.q5,{children:e.sender.name.charAt(0)})]}),(0,a.jsxs)("div",{className:(0,o.cn)("rounded-lg px-4 py-2 max-w-xs lg:max-w-md break-words",e.sender.id===r.id?"bg-primary text-primary-foreground":"bg-card border"),children:[(0,a.jsx)("p",{children:e.text}),(0,a.jsx)("p",{className:(0,o.cn)("text-xs opacity-70 mt-1",e.sender.id===r.id?"text-right":"text-left"),children:e.timestamp})]})]},e.id))})}),(0,a.jsx)("div",{className:"p-4 border-t bg-card",children:(0,a.jsxs)("form",{onSubmit:C,className:"flex items-center gap-2",children:[(0,a.jsx)(g.T,{placeholder:"Type a message...",value:k,onChange:e=>I(e.target.value),className:"flex-1 resize-none",rows:1,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),C(e))}}),(0,a.jsx)(n.$,{type:"submit",size:"icon",disabled:!k.trim(),children:(0,a.jsx)(h.A,{className:"h-5 w-5"})})]})})]}):(0,a.jsx)("div",{className:"hidden md:flex flex-1 items-center justify-center text-muted-foreground p-8",children:(0,a.jsx)(N,{})})})]})}var k=r(8030),I=r(8856);let E=()=>(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(I.E,{className:"h-12 w-12 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsx)(I.E,{className:"h-4 w-3/4"}),(0,a.jsx)(I.E,{className:"h-4 w-1/2"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(I.E,{className:"h-12 w-12 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsx)(I.E,{className:"h-4 w-3/4"}),(0,a.jsx)(I.E,{className:"h-4 w-1/2"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(I.E,{className:"h-12 w-12 rounded-full"}),(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsx)(I.E,{className:"h-4 w-3/4"}),(0,a.jsx)(I.E,{className:"h-4 w-1/2"})]})]})]});function C(){let{user:e,userDetails:s}=(0,k.A)(),[r,l]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),d=e?{id:e.uid,uid:e.uid,name:e.displayName||"Anonymous",avatarUrl:e.photoURL||"https://placehold.co/100x100.png"}:null;return((0,t.useEffect)(()=>{if(!e||!s||!s.friends||0===s.friends.length){l([]),i(!1);return}let r=(0,v.P)((0,v.rJ)(b.db,"conversations"),(0,v._M)("participantIds","array-contains",e.uid),(0,v._M)("participantIds","array-contains-any",s.friends.map(e=>e.id))),a=(0,v.aQ)(r,async s=>{let r=s.docs.map(async s=>{var r;let a=s.data(),t=a.participantIds.find(s=>s!==e.uid);if(!t)return null;let l=await (0,v.x7)((0,v.H9)(b.db,"users",t));if(!l.exists())return null;let n={id:l.id,...l.data()},i=a.lastMessage;return{id:s.id,participant:n,messages:i?[{id:"last",senderId:i.senderId,sender:i.senderId===(null==d?void 0:d.id)?d:n,text:i.text,timestamp:(null==(r=i.timestamp)?void 0:r.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"...",read:i.read}]:[]}});l((await Promise.all(r)).filter(Boolean)),i(!1)});return()=>a()},[e,s,d]),n)?(0,a.jsx)(E,{}):d&&s&&s.friends&&0!==s.friends.length?(0,a.jsx)(w,{conversations:r,currentUser:d}):(0,a.jsx)(N,{})}},6104:(e,s,r)=>{"use strict";r.d(s,{IG:()=>o,db:()=>c,hJ:()=>u,j2:()=>d,sm:()=>m});var a=r(3915),t=r(3004),l=r(5317),n=r(858);let i=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({projectId:"yrdly-coyig",appId:"1:166095077947:web:2f5285213610bbd893521e",storageBucket:"yrdly-coyig.firebasestorage.app",apiKey:"AIzaSyCOE_L6g9c3J6jhcajVzNkC4flEao4Av2I",authDomain:"yrdly-coyig.firebaseapp.com",measurementId:"",messagingSenderId:"166095077947"}),d=(0,t.xI)(i),c=(0,l.aU)(i),o=(0,n.c7)(i),u=new t.HF,m=new t.LD("apple.com")},6695:(e,s,r)=>{"use strict";r.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>n,aR:()=>i,wL:()=>u});var a=r(5155),t=r(2115),l=r(9434);let n=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...t})});n.displayName="Card";let i=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...t})});i.displayName="CardHeader";let d=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...t})});d.displayName="CardTitle";let c=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",r),...t})});c.displayName="CardDescription";let o=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",r),...t})});o.displayName="CardContent";let u=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",r),...t})});u.displayName="CardFooter"},8030:(e,s,r)=>{"use strict";r.d(s,{A:()=>o,AuthProvider:()=>c});var a=r(5155),t=r(2115),l=r(3004),n=r(6104),i=r(5317);let d=(0,t.createContext)({user:null,userDetails:null,loading:!0}),c=e=>{let{children:s}=e,[r,c]=(0,t.useState)(null),[o,u]=(0,t.useState)(null),[m,f]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{let e=(0,l.hg)(n.j2,e=>{if(c(e),e){let s=(0,i.H9)(n.db,"users",e.uid),r=(0,i.aQ)(s,e=>{e.exists()?u({id:e.id,...e.data()}):u(null),f(!1)});return()=>r()}u(null),f(!1)});return()=>e()},[]),(0,a.jsx)(d.Provider,{value:{user:r,userDetails:o,loading:m},children:s})},o=()=>(0,t.useContext)(d)},8539:(e,s,r)=>{"use strict";r.d(s,{T:()=>n});var a=r(5155),t=r(2115),l=r(9434);let n=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,a.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...t})});n.displayName="Textarea"},8856:(e,s,r)=>{"use strict";r.d(s,{E:()=>l});var a=r(5155),t=r(9434);function l(e){let{className:s,...r}=e;return(0,a.jsx)("div",{className:(0,t.cn)("animate-pulse rounded-md bg-muted",s),...r})}},9434:(e,s,r)=>{"use strict";r.d(s,{cn:()=>l});var a=r(2596),t=r(9688);function l(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,t.QP)((0,a.$)(s))}},9907:(e,s,r)=>{Promise.resolve().then(r.bind(r,4607))}},e=>{var s=s=>e(e.s=s);e.O(0,[992,644,340,172,874,333,441,684,358],()=>s(9907)),_N_E=e.O()}]);