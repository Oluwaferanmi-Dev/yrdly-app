(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[149],{1920:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(157).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},3662:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(157).A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4301:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},4619:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>S});var s=n(5155),a=n(285),l=n(157);let r=(0,l.A)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);var i=n(8046),d=n(2177),c=n(221),o=n(5594),h=n(4165),m=n(2523),x=n(8539),u=n(7759),v=n(4301),j=n(3662),p=n(1394),y=n(8030),f=n(2115),g=n(5317),N=n(858),k=n(6104),b=n(7481);let w=o.Ik({title:o.Yj().min(1,"Event title can't be empty.").max(100),description:o.Yj().min(1,"Event description can't be empty.").max(1e3),location:o.Yj().min(1,"Location can't be empty."),eventDate:o.Yj().min(1,"Date can't be empty."),eventTime:o.Yj().min(1,"Time can't be empty."),eventLink:o.Yj().optional()});function M(e){var t;let{children:n,onOpenChange:l}=e,{user:r}=(0,y.A)(),{toast:i}=(0,b.dj)(),[o,M]=(0,f.useState)(!1),[A,E]=(0,f.useState)(!1),[C,L]=(0,f.useState)(null),D=(0,d.mN)({resolver:(0,c.u)(w),defaultValues:{title:"",description:"",location:"",eventDate:"",eventTime:"",eventLink:""}});async function z(e){if(!r)return void i({variant:"destructive",title:"Not authenticated",description:"You must be logged in to create an event."});E(!0);try{var t;let n="";if(C){let e=(0,N.KR)(k.IG,"event_images/".concat(r.uid,"/").concat(Date.now(),"_").concat(C.name)),t=await (0,N.D)(e,C);n=await (0,N.qk)(t.ref)}let s={userId:r.uid,authorName:r.displayName||"Anonymous User",authorImage:r.photoURL||"https://placehold.co/100x100.png?text=".concat((null==(t=r.displayName)?void 0:t.charAt(0))||"A"),category:"Event",title:e.title,text:e.description,location:e.location,eventDate:e.eventDate,eventTime:e.eventTime,eventLink:e.eventLink||"",imageUrl:n,timestamp:(0,g.O5)(),likes:0,likedBy:[],commentCount:0,attendees:[]};await (0,g.gS)((0,g.rJ)(k.db,"posts"),s),i({title:"Event created!",description:"Your event is now live."}),D.reset(),L(null),M(!1)}catch(e){console.error("Error creating event:",e),i({variant:"destructive",title:"Error",description:"Failed to create event."})}finally{E(!1)}}return(0,s.jsxs)(h.lG,{open:o,onOpenChange:e=>{M(e),l&&l(e),e||(D.reset(),L(null))},children:[(0,s.jsx)(h.zM,{asChild:!0,children:n||(0,s.jsxs)("div",{className:"flex items-center gap-4 w-full",children:[(0,s.jsxs)(p.eu,{children:[(0,s.jsx)(p.BK,{src:(null==r?void 0:r.photoURL)||"https://placehold.co/100x100.png","data-ai-hint":"person portrait"}),(0,s.jsx)(p.q5,{children:(null==r||null==(t=r.displayName)?void 0:t.charAt(0))||"U"})]}),(0,s.jsx)("div",{className:"flex-1 text-left text-muted-foreground cursor-pointer hover:bg-muted p-2 rounded-md border border-dashed",children:"Organize an event in your neighborhood?"}),(0,s.jsx)(a.$,{variant:"ghost",size:"icon",children:(0,s.jsx)(v.A,{className:"h-6 w-6 text-primary"})})]})}),(0,s.jsxs)(h.Cf,{className:"sm:max-w-[525px]",children:[(0,s.jsxs)(h.c7,{children:[(0,s.jsx)(h.L3,{children:"Create Event"}),(0,s.jsx)(h.rr,{children:"Plan and share your neighborhood event."})]}),(0,s.jsx)(u.lV,{...D,children:(0,s.jsxs)("form",{onSubmit:D.handleSubmit(z),className:"space-y-4",children:[(0,s.jsx)(u.zB,{control:D.control,name:"title",render:e=>{let{field:t}=e;return(0,s.jsxs)(u.eI,{children:[(0,s.jsx)(u.lR,{children:"Event Title"}),(0,s.jsx)(u.MJ,{children:(0,s.jsx)(m.p,{placeholder:"e.g. Neighborhood Block Party",...t})}),(0,s.jsx)(u.C5,{})]})}}),(0,s.jsx)(u.zB,{control:D.control,name:"description",render:e=>{let{field:t}=e;return(0,s.jsxs)(u.eI,{children:[(0,s.jsx)(u.lR,{children:"Description"}),(0,s.jsx)(u.MJ,{children:(0,s.jsx)(x.T,{placeholder:"Tell everyone about your event...",className:"resize-none min-h-[120px]",...t})}),(0,s.jsx)(u.C5,{})]})}}),(0,s.jsx)(u.zB,{control:D.control,name:"location",render:e=>{let{field:t}=e;return(0,s.jsxs)(u.eI,{children:[(0,s.jsx)(u.lR,{children:"Location"}),(0,s.jsx)(u.MJ,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(j.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(m.p,{placeholder:"Event location",className:"pl-8",...t})]})}),(0,s.jsx)(u.C5,{})]})}}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(u.zB,{control:D.control,name:"eventDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(u.eI,{children:[(0,s.jsx)(u.lR,{children:"Date"}),(0,s.jsx)(u.MJ,{children:(0,s.jsx)(m.p,{type:"date",...t})}),(0,s.jsx)(u.C5,{})]})}}),(0,s.jsx)(u.zB,{control:D.control,name:"eventTime",render:e=>{let{field:t}=e;return(0,s.jsxs)(u.eI,{children:[(0,s.jsx)(u.lR,{children:"Time"}),(0,s.jsx)(u.MJ,{children:(0,s.jsx)(m.p,{type:"time",...t})}),(0,s.jsx)(u.C5,{})]})}})]}),(0,s.jsx)(u.zB,{control:D.control,name:"eventLink",render:e=>{let{field:t}=e;return(0,s.jsxs)(u.eI,{children:[(0,s.jsx)(u.lR,{children:"Event Link (Optional)"}),(0,s.jsx)(u.MJ,{children:(0,s.jsx)(m.p,{placeholder:"Link to tickets or more info",...t})}),(0,s.jsx)(u.C5,{})]})}}),(0,s.jsxs)(u.eI,{children:[(0,s.jsx)(u.lR,{children:"Add an image (Optional)"}),(0,s.jsx)(u.MJ,{children:(0,s.jsx)(m.p,{type:"file",accept:"image/*",onChange:e=>{var t;(null==(t=e.target.files)?void 0:t[0])&&L(e.target.files[0])}})})]}),(0,s.jsx)(h.Es,{children:(0,s.jsx)(a.$,{type:"submit",className:"w-full",variant:"default",disabled:A,children:A?"Creating...":"Create Event"})})]})})]})]})}var A=n(6695),E=n(1920);let C=(0,l.A)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var L=n(6766);function D(e){var t,n;let{event:l}=e,{user:r}=(0,y.A)(),[i,d]=(0,f.useState)((null==(t=l.attendees)?void 0:t.length)||0),[c,o]=(0,f.useState)((null==(n=l.attendees)?void 0:n.includes((null==r?void 0:r.uid)||""))||!1),[h,m]=(0,f.useState)(!1);(0,f.useEffect)(()=>{let e=(0,g.H9)(k.db,"posts",l.id),t=(0,g.aQ)(e,e=>{if(e.exists()){let t=e.data().attendees||[];d(t.length),o(t.includes((null==r?void 0:r.uid)||""))}});return()=>t()},[l.id,null==r?void 0:r.uid]);let x=async()=>{if(!r)return void console.log("User not logged in");m(!0);let e=(0,g.H9)(k.db,"posts",l.id);try{c?await (0,g.mZ)(e,{attendees:(0,g.C3)(r.uid)}):await (0,g.mZ)(e,{attendees:(0,g.hq)(r.uid)})}catch(e){console.error("Error updating attendance:",e)}finally{m(!1)}};return(0,s.jsxs)(A.Zp,{className:"flex flex-col",children:[l.imageUrl&&(0,s.jsx)("div",{className:"relative w-full h-48 rounded-t-lg overflow-hidden",children:(0,s.jsx)(L.default,{src:l.imageUrl,alt:l.text,fill:!0,style:{objectFit:"cover"},"data-ai-hint":"event image"})}),(0,s.jsxs)(A.aR,{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,s.jsxs)(p.eu,{children:[(0,s.jsx)(p.BK,{src:l.authorImage,alt:l.authorName,"data-ai-hint":"person portrait"}),(0,s.jsx)(p.q5,{children:l.authorName.charAt(0)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-semibold",children:l.authorName}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:l.timestamp})]})]}),(0,s.jsx)("h3",{className:"text-xl font-semibold",children:l.text})]}),(0,s.jsxs)(A.Wu,{className:"space-y-3",children:[l.location&&(0,s.jsxs)("div",{className:"flex items-center text-muted-foreground text-sm",children:[(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4"})," ",l.location]}),(l.eventDate||l.eventTime)&&(0,s.jsxs)("div",{className:"flex items-center text-muted-foreground text-sm",children:[(0,s.jsx)(E.A,{className:"mr-2 h-4 w-4"}),l.eventDate," ",l.eventDate&&l.eventTime?"at":""," ",l.eventTime]}),l.eventLink&&(0,s.jsxs)("div",{className:"flex items-center text-sm",children:[(0,s.jsx)(C,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)("a",{href:l.eventLink,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline truncate",children:l.eventLink})]})]}),(0,s.jsxs)(A.wL,{className:"flex justify-between items-center",children:[(0,s.jsx)(a.$,{variant:c?"secondary":"default",onClick:x,disabled:h||!r,children:c?"Attending":"Attend"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[i," ",1===i?"attending":"attendees"]}),l.eventLink&&!c&&(0,s.jsx)(a.$,{variant:"outline",asChild:!0,children:(0,s.jsx)("a",{href:l.eventLink,target:"_blank",rel:"noopener noreferrer",children:"More Info"})})]})]})}var z=n(8856);function I(){return(0,s.jsxs)("div",{className:"text-center py-16",children:[(0,s.jsx)("div",{className:"inline-block bg-muted p-4 rounded-full mb-4",children:(0,s.jsx)(r,{className:"h-12 w-12 text-muted-foreground"})}),(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"No upcoming events"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2 mb-6",children:"Be the first to organize something in your neighborhood!"}),(0,s.jsx)(M,{children:(0,s.jsxs)(a.$,{children:[(0,s.jsx)(i.A,{className:"mr-2 h-4 w-4"})," Create Event"]})})]})}function S(){let[e,t]=(0,f.useState)([]),[n,l]=(0,f.useState)(!0);return(0,f.useEffect)(()=>{let e=(0,g.P)((0,g.rJ)(k.db,"posts"),(0,g._M)("category","==","Event"),(0,g.My)("timestamp","desc")),n=(0,g.aQ)(e,e=>{t(e.docs.map(e=>{var t,n;let s=e.data();return{id:e.id,...s,timestamp:null!=(n=null==(t=s.timestamp)?void 0:t.toDate().toLocaleString())?n:new Date().toLocaleString()}})),l(!1)});return()=>n()},[]),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-bold font-headline",children:"Events"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Discover and create community events."})]}),(0,s.jsx)(M,{children:(0,s.jsxs)(a.$,{children:[(0,s.jsx)(i.A,{className:"mr-2 h-4 w-4"})," Create Event"]})})]}),n?(0,s.jsxs)("div",{className:"space-y-4 max-w-2xl mx-auto",children:[(0,s.jsx)(z.E,{className:"h-48 w-full"}),(0,s.jsx)(z.E,{className:"h-48 w-full"})]}):e.filter(e=>"Event"===e.category).length>0?(0,s.jsx)("div",{className:"space-y-4 max-w-2xl mx-auto",children:e.filter(e=>"Event"===e.category).map(e=>(0,s.jsx)(D,{event:e},e.id))}):(0,s.jsx)(I,{})]})}},6134:(e,t,n)=>{Promise.resolve().then(n.bind(n,4619))},8046:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(157).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[992,644,340,172,434,646,766,722,942,441,684,358],()=>t(6134)),_N_E=e.O()}]);